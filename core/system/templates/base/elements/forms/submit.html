<script>
    $(document).ready(function () {
        $('#ModalFormSubmit, .form-ajax-submit').on('submit', function (e) {
            e.preventDefault();
            let form = this;
            let parameters = new FormData(form);

            submit_with_ajax(window.location.pathname, parameters, function (data) {
                Swal.fire({
                    icon: 'success',
                    title: 'Éxito',
                    text: data.message || 'Operación realizada correctamente.',
                });
                if (data.file_url) {
                    window.open(data.file_url, '_blank');
                } else if (data.redirect_url) {
                    location.href = data.redirect_url;
                } else {
                    tblClient.ajax.reload(null, false);
                }
            }, function (data) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: data.error || 'Ocurrió un error inesperado.',
                });
            });
        });
    });
</script>
